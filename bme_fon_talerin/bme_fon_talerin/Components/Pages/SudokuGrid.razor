@page "/sudokuGrid"
@using System.Text.Json
@using bme_fon_talerin.Data
@using bme_fon_talerin.Data.Models
@using bme_fon_talerin.Models
@attribute [StreamRendering]

@inject TalerinContext Context

<style>
        .sudokugrid {
            aspect-ratio: 1 / 1;
            height: min(75vh, 65vw);
            width: min(75vh, 65vw);
            display: grid;
            grid-template-columns: @GridLayout;
            background-color: black;
            border: solid black 5px;
            cursor: pointer;
        }
        .cell {
            aspect-ratio: 1 / 1;
            width: 100%;
            height: 100%;
            background-color: #f1f1f1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 5px;
            border-color: black;
            border-width: 1px;
            border-style: solid;
        }
        .cell.value {
            font-size: 3rem;
        }
        .cell.selected {
            background-color: lightblue;
        }
        .cell.pencilmarks {
            font-size: 1rem;
        }
        .cell.borderright {
            border-right-width: 3px;
            padding-right: 3px;
        }
        .cell.borderleft {
            border-left-width: 3px;
            padding-left: 3px;
        }
        .cell.bordertop {
            border-top-width: 3px;
            padding-top: 3px;
        }
        .cell.borderbottom {
            border-bottom-width: 3px;
            padding-bottom: 3px;
        }
</style>


<PageTitle>SudokuGrid</PageTitle>

<p>Sudoku Grid</p>

<div class="sudokugrid">
    @for (var row = 0; row < SudokuData.Size; row++)
    {
        @for (var column = 0; column < SudokuData.Size; column++)
        {
            <SudokuCell Row="row" Column="column" Value="GivenCells[row][column]"></SudokuCell>
        }
    }
</div>

@code {
    private Sudoku SudokuData { get; set; }

    private int?[][] GivenCells { get; set; }

    private string GridLayout { get; set; } = "";

    protected override async Task OnInitializedAsync()
    {
        SudokuData = Context.Sudokus.First();

        GivenCells = JsonSerializer.Deserialize<SudokuGridCells>(SudokuData.GivenCells).Cells;

        for (var size = 0; size < SudokuData.Size; size++)
        {
            GridLayout += " auto";
        }
    }
}